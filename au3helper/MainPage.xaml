<Page
    x:Class="au3helper.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:au3helper"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    x:Name="Mainpage"
    mc:Ignorable="d"
    Loaded="Mainpage_Loaded"
    >
    <Page.Resources>
        
        <!--#region 移动鼠标设置-->
        <Flyout x:Name="mousemove_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>移动鼠标到指定位置</TextBlock>
                    <TextBlock>水平值（x）</TextBlock>
                    <TextBox x:Name="move_x" Margin="0,4"></TextBox>
                    <TextBlock>垂直值（y）</TextBlock>
                    <TextBox x:Name="move_y" Margin="0,4"></TextBox>
                    <CheckBox x:Name="move_adv" Content="显示高级选项" Click="move_adv_Click"/>
                    <TextBlock x:Name="move_text_s" Visibility="Collapsed">移动速度</TextBlock>
                    <Slider x:Name="move_s" Minimum="-100" Maximum="0" Value="-10" Visibility="Collapsed"></Slider>
                    <Button x:Name="btn_insertmmove" Click="btn_insertmmove_Click">插入</Button>
                </StackPanel>
            </Grid>
        </Flyout>
        <!--#endregion-->
        
        <!--#region 点击鼠标设置-->
        <Flyout x:Name="mouseclick_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>点击按键</TextBlock>
                    <TextBlock Width="300" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}">默认情况下，主要按键为鼠标左键，但如果在左手模式的情况下，主要按键为右键。</TextBlock>
                    <TextBlock Width="300" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}">但是，如果设置了鼠标左键或者鼠标右键，则始终会按下鼠标左键或者鼠标右键。</TextBlock>
                    <ComboBox x:Name="click_key" SelectedIndex="3" Margin="0,4">
                        <ComboBoxItem>左键</ComboBoxItem>
                        <ComboBoxItem>中键</ComboBoxItem>
                        <ComboBoxItem>右键</ComboBoxItem>
                        <ComboBoxItem>主要按键</ComboBoxItem>
                        <ComboBoxItem>次要按键</ComboBoxItem>
                    </ComboBox>
                    <CheckBox x:Name="click_adv" Content="显示高级选项" Click="click_adv_Click"/>
                    <TextBlock x:Name="click_x_text" Visibility="Collapsed">水平值（x）</TextBlock>
                    <TextBox x:Name="click_x" Margin="0,4" Visibility="Collapsed"></TextBox>
                    <TextBlock x:Name="click_y_text" Visibility="Collapsed">垂直值（y）</TextBlock>
                    <TextBox x:Name="click_y" Margin="0,4" Visibility="Collapsed"></TextBox>
                    <TextBlock x:Name="click_times_text" Visibility="Collapsed">点击次数</TextBlock>
                    <TextBox x:Name="click_times" Margin="0,4" Visibility="Collapsed"></TextBox>
                    <TextBlock x:Name="click_move_s_text" Visibility="Collapsed">鼠标移动速度</TextBlock>
                    <Slider x:Name="click_move_s" Minimum="-100" Maximum="0" Value="-10" Visibility="Collapsed"></Slider>
                    <Button x:Name="btn_insertclick_click" Click="btn_insertclick_click_Click">插入</Button>
                </StackPanel>
            </Grid>
        </Flyout>
        <!--#endregion-->
        
        <!--#region 发送按键设置-->
        <Flyout x:Name="sendkey_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>发送按键</TextBlock>
                    <TextBox Margin="0,4" x:Name="insertkey"></TextBox>
                    <TextBlock Margin="0,4" Width="200" Text="如果使用下述功能键，请避免再次在输入框进行输入" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}"/>
                    <ToggleButton Margin="0,4" x:Name="key_s" Content="Shift 键（+）"/>
                    <ToggleButton Margin="0,4" x:Name="key_c" Content="Ctrl 键（^）"/>
                    <ToggleButton Margin="0,4" x:Name="key_a" Content="Alt 键（!）"/>
                    <ToggleButton Margin="0,4" x:Name="key_w" Content="Win 键（#）"/>
                    <TextBlock Text="原始输入（不接受组合键）" />
                    <ToggleSwitch x:Name="key_raw" Toggled="key_raw_Toggled"/>
                    <Button x:Name="btn_insertkey" Content="插入" Click="btn_insertkey_Click"/>
                </StackPanel>
            </Grid>
        </Flyout>
        <!--#endregion-->
        
        <!--#region 控件点击设置-->
        <Flyout x:Name="controlclick_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>查找窗口标题</TextBlock>
                    <TextBox x:Name="c_click_title" Margin="0,4"></TextBox>
                    <TextBlock>查找窗口内可见字符串</TextBlock>
                    <TextBox x:Name="c_click_string" Margin="0,4"></TextBox>
                    <TextBlock>窗口内控件 ID</TextBlock>
                    <TextBox x:Name="c_click_id" Margin="0,4"></TextBox>
                    <CheckBox x:Name="c_click_adv" Content="显示高级选项" Click="c_click_adv_Click"/>
                    <TextBlock x:Name="c_click_key_text" Visibility="Collapsed">点击按键</TextBlock>
                    <TextBlock x:Name="c_click_key_text2" Width="300" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}" Visibility="Collapsed">默认情况下，主要按键为鼠标左键，但如果在左手模式的情况下，主要按键为右键。</TextBlock>
                    <TextBlock x:Name="c_click_key_text3" Width="300" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}" Visibility="Collapsed">但是，如果设置了鼠标左键或者鼠标右键，则始终会按下鼠标左键或者鼠标右键。</TextBlock>
                    <ComboBox x:Name="c_click_key" SelectedIndex="3" Margin="0,4" Visibility="Collapsed">
                        <ComboBoxItem>左键</ComboBoxItem>
                        <ComboBoxItem>中键</ComboBoxItem>
                        <ComboBoxItem>右键</ComboBoxItem>
                        <ComboBoxItem>主要按键</ComboBoxItem>
                        <ComboBoxItem>次要按键</ComboBoxItem>
                    </ComboBox>
                    <TextBlock x:Name="c_click_times_text" Visibility="Collapsed">点击次数</TextBlock>
                    <TextBox x:Name="c_click_times" Margin="0,4" Visibility="Collapsed"/>
                    <Button x:Name="btn_controlclick" Content="插入" Click="btn_controlclick_Click"/>
                </StackPanel>
            </Grid>
        </Flyout>
        <!--#endregion-->

        <!--#region 暂停设置，已迁移至 sleep_cdlg-->
        <!--
        <Flyout x:Name="sleep_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>暂停时间（毫秒）</TextBlock>
                    <TextBox x:Name="sleep_times" Margin="0,4"/>
                    <Button x:Name="btn_sleep" Content="插入" Click="btn_sleep_Click"/>
                </StackPanel>
            </Grid>
        </Flyout>
        -->
        <!--#endregion-->

        <!--#region  窗口等待-->
        <Flyout x:Name="winwait_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>等待操作</TextBlock>
                    <ComboBox x:Name="ww_set" SelectedIndex="0" Margin="0,4">
                        <ComboBoxItem>等待出现</ComboBoxItem>
                        <ComboBoxItem>等待激活</ComboBoxItem>
                        <ComboBoxItem>等待关闭</ComboBoxItem>
                        <ComboBoxItem>等待非激活</ComboBoxItem>
                    </ComboBox>
                    <TextBlock>查找窗口标题</TextBlock>
                    <TextBox x:Name="ww_title" Margin="0,4"/>
                    <TextBlock>查找窗口内可见字符串</TextBlock>
                    <TextBox x:Name="ww_string" Margin="0,4"/>
                    <TextBlock>超时（毫秒）</TextBlock>
                    <TextBlock Width="200" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}">如果等待时间超过该值，则等待失败，继续执行。</TextBlock>
                    <TextBox x:Name="ww_timeout" Margin="0,4"/>
                    <Button x:Name="btn_winwait" Content="插入" Click="btn_winwait_Click"/>
                </StackPanel>
            </Grid>
        </Flyout>
        <!--#endregion-->

        <Flyout x:Name="run_fly">
            <Grid>
                <StackPanel>
                    <TextBlock>运行程序</TextBlock>
                    <TextBlock Width="200" TextWrapping="Wrap" Foreground="{ThemeResource HyperlinkForegroundThemeBrush}">这里为脚本运行的程序，并非在此应用进行调用。</TextBlock>
                    <TextBox x:Name="run_prog" Margin="0,4"/>
                    <Button x:Name="btn_run_exec" Content="插入" Click="btn_run_exec_Click"/>
                </StackPanel>
            </Grid>
        </Flyout>
    </Page.Resources>
    
    <!--#region 顶部栏按钮-->
    <Page.TopAppBar>
        <CommandBar>
            <CommandBar.Content>
                <Grid/>
            </CommandBar.Content>
            <!--
            <AppBarButton Label="预览">
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf00c;"/>
                </AppBarButton.Icon>
            </AppBarButton>
            -->
            <AppBarButton Label="窗口操作" x:Name="winevt">
                <AppBarButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem Text="等待窗口" x:Name="w_wait" Click="w_wait_Click"/>
                    </MenuFlyout>
                </AppBarButton.Flyout>
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf022;"></FontIcon>
                </AppBarButton.Icon>

            </AppBarButton>
            <AppBarButton Label="鼠标操作" x:Name="mousekey">
                <AppBarButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem Text="鼠标移动" x:Name="m_move" Click="m_move_Click"/>
                        <MenuFlyoutItem Text="鼠标点击" x:Name="m_click" Click="m_click_Click"/>
                    </MenuFlyout>
                </AppBarButton.Flyout>
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf245;"></FontIcon>
                </AppBarButton.Icon>
            </AppBarButton>
            <AppBarButton Label="控件操作" x:Name="clickbtn">
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf25a;"/>
                </AppBarButton.Icon>
                <AppBarButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem x:Name="c_click" Text="控件点击" Click="c_click_Click"/>
                    </MenuFlyout>
                </AppBarButton.Flyout>
            </AppBarButton>
            <AppBarButton Label="按键操作" x:Name="cclickbtn">
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf11c;"/>
                </AppBarButton.Icon>
                <AppBarButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem x:Name="send_key" Text="发送按键" Click="send_key_Click"/>
                    </MenuFlyout>
                </AppBarButton.Flyout>
            </AppBarButton>
            <AppBarButton Label="计时操作" x:Name="timerbtn">
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf017;"/>
                </AppBarButton.Icon>
                <AppBarButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem x:Name="sleep" Text="暂停" Click="sleep_Click"/>
                    </MenuFlyout>
                </AppBarButton.Flyout>
            </AppBarButton>
            <AppBarButton Label="运行操作" x:Name="runbtn">
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf120;"></FontIcon>
                </AppBarButton.Icon>
                <AppBarButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem  x:Name="run_exec" Click="run_exec_Click">运行程序</MenuFlyoutItem>
                    </MenuFlyout>
                </AppBarButton.Flyout>
            </AppBarButton>
            <!--
            <AppBarButton x:Name="l_d_toggle" Label="切换主题" Click="l_d_toggle_Click">
                <AppBarButton.Icon>
                    <FontIcon FontFamily="res/FontAwesome.otf#FontAwesome" Glyph="&#xf042;"></FontIcon>
                </AppBarButton.Icon>
            </AppBarButton>
            -->
            <CommandBar.SecondaryCommands>
                <AppBarButton Label="关于" x:Name="btn_about" Click="btn_about_Click"/>
            </CommandBar.SecondaryCommands>
        </CommandBar>
    </Page.TopAppBar>
    <!--#endregion-->

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" Padding="0,4">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <ScrollViewer>
                    <StackPanel Padding="12,0">
                        <TextBlock HorizontalAlignment="Left">源代码</TextBlock>
                        <TextBox x:Name="rawcode" PlaceholderText="在这里输入代码..." AcceptsReturn="True" TextWrapping="Wrap" LostFocus="rawcode_LostFocus"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
            <Grid Grid.Column="1">
                <ScrollViewer>
                    <StackPanel Padding="12,0">
                        <TextBlock>事件过程</TextBlock>
                        <TextBlock x:Name="converted" TextWrapping="Wrap"></TextBlock>
                    </StackPanel>
                </ScrollViewer>
                <ProgressRing x:Name="converting" IsActive="False" Width="100" Height="100" />
            </Grid>
        </Grid>
    </Grid>
</Page>
